{% extends 'base.html.twig' %}

{% block javascripts %}
    {{ encore_entry_script_tags('home') }}
{% endblock %}

{% block body %}
    <div class="row">
        <div class="col-3">

            {% set ratioUsdEur = totalUsd/totalEur %}
            <table class="table table-sm table-bordered table-striped table-responsive-md table-dark">
                <thead>
                <tr>
                    <th></th>
                    <th class="text-end">{{ ratioUsdEur|round(4) }} $</th>
                    <th class="text-end">1 €</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="text-white">Investi</td>
                    <td class="text-white text-end">{{ (totalDepositEur*ratioUsdEur)|round(0) }} $</td>
                    <td class="text-white text-end">{{ totalDepositEur|round(0) }} €</td>
                </tr>
                <tr>
                    <td class="text-white">Wallet crypto</td>
                    <td class="text-white text-end">{{ totalUsd|round(0) }} $</td>
                    <td class="text-white text-end">{{ totalEur|round(0) }} €</td>
                </tr>
                <tr>
                    <td class="text-white">Wallet stable</td>
                    <td class="text-white text-end">{{ totalUsdStable|round(0) }} $</td>
                    <td class="text-white text-end">{{ totalEurStable|round(0) }} €</td>
                </tr>
                <tr>
                    <td class="text-white">Total</td>
                    <td class="text-white text-end">{{ (totalUsd+totalUsdStable)|round(0) }} $</td>
                    <td class="text-white text-end">{{ (totalEur+totalEurStable)|round(0) }} €</td>
                </tr>
                {# <tr>
                    <td class="text-white">Farming Crypto</td>
                    <td class="text-white text-end">{{ totalUsd|round(0) }} $</td>
                    <td class="text-white text-end">€</td>
                </tr>
                <tr>
                    <td class="text-white">Farming Stable</td>
                    <td class="text-white text-end">{{ totalUsd|round(0) }} $</td>
                    <td class="text-white text-end">€</td>
                </tr>
                <tr>
                    <td class="text-white">Emprunt</td>
                    <td class="text-white text-end">{{ totalUsd|round(0) }} $</td>
                    <td class="text-white text-end">€</td>
                </tr> #}
                </tbody>
            </table>
            <table class="table table-sm table-bordered table-striped table-responsive-md table-dark">
                <tbody>
                {% for position in positions %}
                    <tr>
                        <td class="text-white text-end">{{ position.totalsum|round(2) }}</td>
                        <td class="text-white">{{ position.symbol|upper }}</td>
                        <td class="text-white text-end">{{ position.valueUsd|round(2) }}$</td>
                    </tr>
                {% endfor %}

                </tbody>
            </table>
        </div>
        <div class="col">
            <div class="row mb-1">
                <div class="col-2"></div>
                <div class="col text-center">
                    <p>Mes positions</p>
                    <canvas id="chart-pos"></canvas>
                </div>
                <div class="col-2"></div>
            </div>

            {% if positions_stable|length > 0 %}
                <div class="row">
                    <div class="col-6 text-center">
                        <p>Ratio Crypto/Stable</p>
                        <canvas id="chart-ratio"></canvas>
                    </div>
                    <div class="col-6 text-center">
                        {% if positions_stable|length > 1 %}
                            <p>Mes positions stable</p>
                            <canvas id="chart-stable"></canvas>
                        {% endif %}
                    </div>
                </div>
            {% endif %}
        </div>
    </div>


    <div id="id-array-positions" class="visually-hidden"
         data-pie="{{ positions|json_encode }}"
         data-piestable="{{ positions_stable|json_encode }}"
         data-crypto="{{ totalUsd }}"
         data-stable="{{ totalUsdStable }}">
    </div>
{% endblock %}
